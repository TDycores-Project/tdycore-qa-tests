SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE RICHARDS
    /
  /
END

SUBSURFACE

GRID
  TYPE structured
  NXYZ swap{nx,10} 1 1
  BOUNDS
    0.d0 0.d0 0.d0
    100.d0 1.d0 1.d0
  END
END

REGION all
  COORDINATES
    0.d0 0.d0 0.d0
    100d0 1d0 1d0
  /  
END

REGION left_end
  FACE WEST
  COORDINATES
    0.d0 0.d0 0.d0
    0.d0 1d0 1d0
  /
END

REGION right_end
  FACE EAST
  COORDINATES
    100d0 0.d0 0.d0
    100d0 1d0 1d0
  /
END

REGION obs_pt
  COORDINATE 15d0 0.5d0 0.5d0
END

OBSERVATION
  REGION obs_pt
  VELOCITY
END

MATERIAL_PROPERTY beam
  ID 1
  POROSITY 0.20
  TORTUOSITY 1.d0
  ROCK_DENSITY 2.0d3
  CHARACTERISTIC_CURVES cc1
  PERMEABILITY
    PERM_X 1.d-14
    PERM_Y 1.d-14
    PERM_Z 1.d-14
  /
END

CHARACTERISTIC_CURVES cc1
  SATURATION_FUNCTION VAN_GENUCHTEN
    LIQUID_RESIDUAL_SATURATION 0.5d-1
    M 0.75
    ALPHA 1.d-3
  /
  PERMEABILITY_FUNCTION MUALEM
    LIQUID_RESIDUAL_SATURATION 0.1d0
    M 0.5d0
  /
  PERMEABILITY_FUNCTION MUALEM_VG_GAS
    LIQUID_RESIDUAL_SATURATION 0.1d0
    GAS_RESIDUAL_SATURATION 0.1d0
    M 0.5d0
  /
END

EOS WATER
  DENSITY EXPONENTIAL 1000. 101325. 1.0d-9
  VISCOSITY CONSTANT 1.728d-3
END

FLUID_PROPERTY
  DIFFUSION_COEFFICIENT 1.d-9
END

LINEAR_SOLVER FLOW
  SOLVER DIRECT
  ZERO_PIVOT_TOL 1.d-20
END

STRATA
  REGION all
  MATERIAL beam
END

TIME
  FINAL_TIME 0.50 day
  INITIAL_TIMESTEP_SIZE 1.d-4 day
  MAXIMUM_TIMESTEP_SIZE 0.0001 day at 0.d0 day
END

OUTPUT
  SNAPSHOT_FILE
    TIMES day 0.05 0.1 0.25
    #NO_PRINT_INITIAL
    FORMAT HDF5
  /
  OBSERVATION_FILE
    PERIODIC TIME 0.05 day
    #NO_PRINT_INITIAL
    #FORMAT HDF5
  /
END

DATASET pressure_initial
  HDF5_DATASET_NAME initial
  FILENAME ./dataset_kolditz9.hdf5
END

FLOW_CONDITION initial
  TYPE
    PRESSURE dirichlet
  /
  PRESSURE DATASET pressure_initial
END

FLOW_CONDITION left_end
  TYPE
    FLUX neumann
  /
  FLUX 0.d0 m/yr
END

FLOW_CONDITION right_end
  TYPE
    FLUX neumann
  /
  FLUX 0.d0 m/yr
END

INITIAL_CONDITION initial
  REGION all
  FLOW_CONDITION initial
END

BOUNDARY_CONDITION left_end
  REGION left_end
  FLOW_CONDITION left_end
END

BOUNDARY_CONDITION right_end
  REGION right_end
  FLOW_CONDITION right_end
END


END_SUBSURFACE